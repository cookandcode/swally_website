// Generated by CoffeeScript 1.6.3
(function() {
  window.myApp.controller('mapController', [
    'Stats', '$scope', function(Stats, $scope) {
      return $scope.allStats = Stats.query(function() {
        var k, lat_plus_long, map, mapOptions, marker, myLatlng, stat, tab_stats, _ref, _results;
        mapOptions = {
          center: new google.maps.LatLng(46.75984, 1.738281),
          zoom: 5,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map"), mapOptions);
        tab_stats = {};
        _ref = $scope.allStats;
        _results = [];
        for (k in _ref) {
          stat = _ref[k];
          lat_plus_long = stat.lat + stat.long;
          if (tab_stats[lat_plus_long]) {
            tab_stats[lat_plus_long]++;
            console.log('OK');
          } else {
            tab_stats[lat_plus_long] = 1;
            console.log('NOT OK');
          }
          if (parseInt(k) === 10) {
            myLatlng = new google.maps.LatLng(stat.lat, stat.long);
            _results.push(marker = new google.maps.Marker({
              position: myLatlng,
              map: map,
              animation: google.maps.Animation.DROP,
              title: "Hello World!"
            }));
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      });
    }
  ]);

}).call(this);
