// Generated by CoffeeScript 1.6.3
(function() {
  window.myApp.controller('statController', [
    'Stats', 'StatsShared', '$scope', function(Stats, StatsShared, $scope) {
      return StatsShared.getStats(function() {
        var city, infowindow, map, mapOptions, marker, myLatlng, stat, _ref, _results;
        $scope.allStats = StatsShared.allStatsByCity;
        $scope.ranked_cities = StatsShared.ranking_tab;
        console.log($scope.ranked_cities);
        mapOptions = {
          center: new google.maps.LatLng(46.75984, 1.738281),
          zoom: 5,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map"), mapOptions);
        _ref = $scope.allStats;
        _results = [];
        for (city in _ref) {
          stat = _ref[city];
          myLatlng = new google.maps.LatLng(stat.location.lat, stat.location.long);
          infowindow = new google.maps.InfoWindow({
            content: stat.swallow + ' gorgee(s) bue(s) a ' + city
          });
          marker = new google.maps.Marker({
            position: myLatlng,
            map: map,
            clickable: true,
            animation: google.maps.Animation.DROP
          });
          _results.push(google.maps.event.addListener(marker, 'click', function() {
            return infowindow.open(map, marker);
          }));
        }
        return _results;
      });
    }
  ]);

}).call(this);
